package ex0211.overriding.goods;
/**
  ê°? ??ì²??? ???? ë¡?ì§?(ê¸°ë??)?? ?´ë?¹í?? ?´ë????
  (?±ë? , ??ì²´ê???, ë¶?ë¶?ê²???, ????, ???? ?±ë??.....)
*/
public class GoodsService{

	//?????? ê´?ë¦¬í?? ë°°ì?? ????
	private Goods [] goodsArr = new Goods [6];
	public static int count;//0 ë°°ì?´ë°©?? ???? ê°?ì²´ì?? ê°??? 

   /**
      ì´?ê¸°ì? ?°ì?´í?°ë?? ?¸í?????? ë©?????
	  String [][] data = new String [][]{
			 {"A01" , "???°ê¹¡" , "2500" , "ì§?ê³? ë§?????."},  //---> Goods 
			 {"A02" , "ê³?êµ¬ë?ê¹?" , "3500" , "ê³?êµ¬ë??´ê? ?¬ë??."},  //---> Goods 
			 {"A03" , "ê°???ê¹?" , "5000" , "ê°???ë§??? ê³?????ë§?."}, // ---> Goods 
			 {"A04" , "????ë²??°ì¹©" , "2200" , "?¬ì½¤ ????."},
			 {"A05" , "ì½?ì¹?" , "3000" , "ê³???????."}
			 
		};
   */
	
	//???±ì?? ì¶?ê°?
	 public GoodsService(String[][] data) { //ë©???java???? ?¤ë?ê°? ????. 
		    for (int i = 0; i < data.length; i++) {
		        if(count < goodsArr.length){
		            goodsArr[count++] = this.create(data[i]);
		}
		        
//   public  void init(String [][] data){//MenuView???? ???¬ë??? 2ì°¨ì??ë°°ì?´ì?? ì£¼ì?? ????
//     for(int i=0; i< data.length ; i++){ //5
//		goodsArr[count++] = this.create( data[i] );	
//	 }

		    
		    }
   }//ë©???????


   /**
      Goodsë¥? ???±í?´ì?? ê°??? ?¤ì????ê³? ???±ë?? Goosë¥? ë¦¬í?´í???? ë©????? 
   */
   private Goods create(String [] row){//{"A01" , "???°ê¹¡" , "2500" , "ì§?ê³? ë§?????."}
         Goods goods = new Goods( );
         goods.setCode( row[0]);
         goods.setName( row[1]);
         goods.setPrice( Integer.parseInt(row[2]));
         goods.setExplain( row[3]);
         
		 return goods;
   }


   /**
     ?±ë?(?±ë??¤í?? - ì¤?ë³µì?¸ê²½??, ë°°ì?´ì?? ê¸¸ì?? ë²??´ë??ê²½ì??)
	 @return : 
			 0?´ë©´ ????ì½??? ì¤?ë³? ,
			 1?´ë©´ ?±ë??±ê³µ, 
			 -1?´ë©´ ë°°ì?´ì?? ê¸¸ì?? ë²??´ë??
   */
   public InsertResult insert(Goods goods){
	   // ë°°ì?´ì?? ê¸¸ì?? ì²´í?? 
	   if(goodsArr.length == GoodsService.count){
            //return -1; enum????
		   return InsertResult.INSERT_OUTINDEX;
	   }

	   //ì¤?ë³µì²´?? 
	  Goods searchGoods = this.selectByCode( goods.getCode() );//null or ì£¼ì??ë¦¬í??
	  
       if(searchGoods!=null){ //ì°¾ì???? ê·¸ë?¬ë??ê¹? ì¤?ë³µì?´ë??.
          //return 0; 
          return InsertResult.INSERT_OUTINDEX;
	   }

	   goodsArr[GoodsService.count++] = goods;
     // return 1;
      return InsertResult.INSERT_OUTINDEX;
   }


   /**
     ??ì²´ê???
   */
   public Goods[]  selectAll( ){
     // System.out.pri
	   System.out.println("servier?? goodsArr  = " + goodsArr);
      return goodsArr;//ì£¼ì??ê°?
   }

   /**
     ????ì½????? ?´ë?¹í???? ???? ê²???
	 @return : ë§??? code?? ?´ë?¹í???? ê°??? ???¼ë©´ Goodsë¥? ë¦¬í?´í??ê³?
	           ???¼ë©´ null ë¦¬í??
   */
   public Goods selectByCode(String code){//a04
        for(int i=0; i< GoodsService.count ; i++){
			Goods goods = goodsArr[i]; //ë°°ì?´ë°©?? ???? ì£¼ì??ê°?
 
            String c = goods.getCode();//???¥ë???´ì???? ????ì½??? êº¼ë?´ê¸° 
            String converUpper = c.toUpperCase(); //???¥ë???? ???? ì½???ë¥? ??ë¬¸ì??ë¡? 

			if(converUpper.equals( code.toUpperCase() ) ){
                 //????. ==ì°¾ì????.
                 return goods;//ì£¼ì??ê°??? ë¦¬í?´ë????. 
			}
		}
        
       
       return null;//ëª»ì°¾????.
   }


   /**
    ????ì½????? ?´ë?¹í???? ê°?ê²?, ?¤ë? ??????ê¸? 
	@return : true?´ë©´ ??????ë£?, false?´ë©´ ?????¤í??
   */
   public boolean update(Goods goods){ //???????¤ë?? ì½???, ë³?ê²½ê? - ê°?ê²?, ?¤ë?
        
	   Goods searchGoods = this.selectByCode(goods.getCode());
	   
		  if(searchGoods != null){ //????..
	          //????????.
	          searchGoods.setPrice( goods.getPrice() );
			  searchGoods.setExplain( goods.getExplain() );

			  return true;
		  }

       return false;
   }
   
  /**
   * ???????¤ë?? ????ì½????? ?´ë?¹í???? ë°°ì?´ì?? ??ì¹?(index) ì°¾ê¸°
   * @param code
   * @return
   */
 	public int findLocate(String code) {
 		for (int i = 0; i < count ; i++) {
 			if(goodsArr[i].getCode().equals(code) ) {
 				return i;
 			}
 		}
 		return -1; //ëª»ì°¾????!
 	}
 	
 	/**
 	 * ???????¤ë?? ????ì½???ë¥? ???? ë°??? 
 	 *  - ????ì½????? ?´ë?¹í???? ??ë³´ë?? ì°¾ê? ???¼ë©´ index(ë²?ì§???)ë¥? ë°?????.
 	 *  - index?? ?´ë?¹í???? ?????? ë°°ì?´ì???? nullë°?ê¾¼ë??.
 	 *  - index ?´í??ë¶??? ???¼ë? ?????? ??ê¸´ë??.
 	 *  - countë³????? ??ì¹??? ë°°ì?´ê³µê°? null ë³?ê²½í????
 	 *  - count ê°???????.
 	 * */
 	public int delete(String code) {
 		int locate = this.findLocate(code);
 		
 		if(locate == -1)return -1;
 		
 		goodsArr[locate]=null; //??ì¹?ë¥? nullë¡? ì´?ê¸°í??
 		
 		for (int i = locate; i < count-1; i++) { //count = 5  -1 = 4
 			goodsArr[i] = goodsArr[i+1];
 		}
 		
 		goodsArr[--count]=null;
 		
 		return 1;
 	}
 	
 
}